{% extends 'main/base.html' %}

{% block title %}Книги - SysLibrary{% endblock %}

{% block content %}
<h1 class="page-title">Наша Коллекция Книг</h1>

<div class="filters">
    <form method="get" class="search-form">
        <input type="text" name="search" placeholder="Поиск книг..." value="{{ search_query }}" class="search-input">
        <select name="genre" class="genre-select">
            <option value="">Все жанры</option>
            {% for genre in genres %}
            <option value="{{ genre.id_genre }}" {% if selected_genre == genre.id_genre|stringformat:"i" %}selected{% endif %}>
                {{ genre.name_genre }}
            </option>
            {% endfor %}
        </select>
        <button type="submit" class="search-btn">Найти</button>
    </form>
</div>

<div class="cards-grid">
    {% for book in books %}
    <div class="card">
        {% if book.cover_image %}
        <img src="{{ book.cover_image.url }}" alt="{{ book.title }}" class="card-image">
        {% else %}
        <div class="card-image" style="display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #f0f0f0, #e0e0e0); color: #999;">
            <i class="fas fa-book" style="font-size: 3rem;"></i>
        </div>
        {% endif %}
        <div class="card-content">
            <h3 class="card-title">{{ book.title }}</h3>
            <p class="card-author">{{ book.id_author.first_name }} {{ book.id_author.last_name }}</p>
            <div class="card-meta">
                <span class="rating">{{ book.age_rating }}</span>
                <span class="year">{{ book.year }} год</span>
            </div>
            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                <a href="{% url 'book_detail' book.id_book %}" style="flex: 1; background: #f8fafc; color: #374151; padding: 0.5rem; text-align: center; border-radius: 6px; text-decoration: none; font-size: 0.9rem; border: 1px solid #e2e8f0;">
                    Подробнее
                </a>
                <a href="{% url 'book_read' book.id_book %}" style="flex: 1; background: #4f46e5; color: white; padding: 0.5rem; text-align: center; border-radius: 6px; text-decoration: none; font-size: 0.9rem;">
                    Читать
                </a>
            </div>
        </div>
    </div>
    {% empty %}
    <div style="grid-column: 1 / -1; text-align: center; color: white; padding: 3rem;">
        <i class="fas fa-search" style="font-size: 4rem; margin-bottom: 1rem;"></i>
        <h2>Книги не найдены</h2>
        <p>Попробуйте изменить параметры поиска</p>
    </div>
    {% endfor %}
</div>
{% endblock %}